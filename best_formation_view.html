<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="Football_Record_Statistics">
<meta name="author" content="LoonyHyun">
<meta property="og:url" content="https://loonyhyun.cafe24.com/">
<meta property="og:title" content="바론 FC 경기 기록실">
<meta property="og:type" content="website">
<meta property="og:image" content="https://loonyhyun.cafe24.com/football_tpm/img/main.png">
<meta property="og:description" content="바론 FC의 경기 기록실 입니다.">
<title>Best11</title>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>

<script src="/football_tpm/bootstrap-datepicker.min.js"></script>
<script src="/football_tpm/bootstrap-datepicker.ko.min.js"></script>
<link href="/football_tpm/bootstrap-datepicker.min.css" rel="stylesheet">

<script src="/football_tpm/team.js"></script>
<link href="/football_tpm/team.css" rel="stylesheet">

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1427445728121282"
crossorigin="anonymous"></script>

<style>
	.bestPlayer {max-width:120px;}
</style>
<script>
	$(document).ready(function(){
		$("#headers").load("/football_tpm/header.html", function(){
			var target_header = "best";
			getTeam();
			$("#header_" + target_header).addClass("text-warning").removeClass("text-white");
			$("#drop_header").text($("#drop_header_" + target_header).text());
		});
		setLayout();
		getSamplePlayers();
		viewBestPlayerList();
	});

	$(window).resize(function(){
		setLayout();
	});

	function setSelectedPosition(){
		$("#POSITION_ATT").html("");
		$("#POSITION_MID").html("");
		$("#POSITION_DEF").html("");
		$("#POSITION_KEEP").html("");

		var val = $("#REG_FORMATION").val();
		if(val == ""){
			return;
		}
		var def = parseInt(val.substring(0, 1));
		var mid = parseInt(val.substring(1, 2));
		var att = parseInt(val.substring(2, 3));

		var playerCnt = 0;
		for(var i=0; i<att; i++, playerCnt++){
			var str  = "<div class='col'>";
				str += "<input type='text' readonly class='bestPlayer form-control form-control-lg' name='bestPlayer' id='player_" + playerCnt + "'/>";
				str += "</div>";
			$("#POSITION_ATT").append(str);
		}

		if(mid == 5){
			$("#POSITION_MID").html("<div class='row' id='POSITION_MID_1'></div><div class='row' id='POSITION_MID_2'></div>");
		}
		for(var i=0; i<mid; i++, playerCnt++){
			if(mid == 5){
				var stylevalue = " style='' ";
				if(i == 0){
					stylevalue = " style='float:right;' ";
				}else if(i == 2){
					stylevalue = " style='float:left;' ";
				}else if(i == 3){
					stylevalue = " style='float:left;' ";
				}else if(i == 4){
					stylevalue = " style='float:right;' ";
				}
				if(i < 3){
					var str  = "<div class='col'>";
						str += "<input type='text' readonly class='bestPlayer form-control form-control-lg' name='bestPlayer' " +stylevalue+" id='player_" + playerCnt + "'/>";
						str += "</div>";
					$("#POSITION_MID_1").append(str);
				}else{
					var str  = "<div class='col'>";
						str += "<input type='text' readonly class='bestPlayer form-control form-control-lg'  name='bestPlayer' " +stylevalue+" id='player_" + playerCnt + "'/>";
						str += "</div>";
					$("#POSITION_MID_2").append(str);
				}
			}else{
				var str  = "<div class='col'>";
					str += "<input type='text' readonly class='bestPlayer form-control form-control-lg' name='bestPlayer' " +stylevalue+" id='player_" + playerCnt + "'/>";
					str += "</div>";
				$("#POSITION_MID").append(str);
			}
		}
		for(var i=0; i<def; i++, playerCnt++){
			var str  = "<div class='col'>";
				str += "<input type='text' readonly class='bestPlayer form-control form-control-lg' name='bestPlayer' id='player_" + playerCnt + "'/>";
				str += "</div>";
			$("#POSITION_DEF").append(str);
		}
		var str  = "<div class='col'>";
			str += "<input type='text' readonly class='bestPlayer form-control form-control-lg' name='bestPlayer' id='player_10'></select>";
			str += "</div>";
		$("#POSITION_KEEP").append(str);
	}



    function getSamplePlayers()
    {
        
        $.ajax({
            type : "post",
            url : './get.php',
            data : {
                cmd : "players",
                id : 1
            },
            dataType : "json",
            success : function(data) {
                for (var i = 0; i < data.length; i++) {
                    var playerId = data[i]["player_id"];
					var str = "<option value='"+playerId+"'>";
						str += data[i]["player_name"];
						str += "</option>";
                    $("#PLAYER_SELECT_SAMPLE").append(str);
                }
            },
            error : function(err) {
                alert("오류발생 관리자에게 문의하세요.")
            }
        });
    }

	function viewBestPlayer(){
		
        $.ajax({
            type : "post",
            url : './get.php',
            data : {
                cmd : "best_formation_view",
                id : 1,
				fid : $("#VIEW_ID").val()
            },
            dataType : "json",
            success : function(data) {
				var tmp = data[0];

				var view = $("#VIEW_BEST_PLAYER_DIV");
				view.html("");
				var regFormation = tmp["reg_formation"];
				var regName = tmp["reg_name"];

				var val = regFormation;
				if(val == ""){
					return;
				}
				var def = parseInt(val.substring(0, 1));
				var mid = parseInt(val.substring(1, 2));
				var att = parseInt(val.substring(2, 3));
				$("#REG_NAME").val(regName);
				$("#REG_FORMATION").val(regFormation);
				setSelectedPosition();

				var attSplit = tmp["player_att"].split("$");
				var midSplit = tmp["player_mid"].split("$");
				var defSplit = tmp["player_def"].split("$");
				var keepSplit = tmp["player_keep"].split("$");
				var playerCnt = 0;
				for(var i=0; i<attSplit.length; i++){
					if(attSplit[i] != ""){
						$("#player_" + playerCnt).val($("#PLAYER_SELECT_SAMPLE > option[value=" + attSplit[i] + "]").text());
						playerCnt++;
					}
				}
				for(var i=0; i<midSplit.length; i++){
					if(midSplit[i] != ""){
						$("#player_" + playerCnt).val($("#PLAYER_SELECT_SAMPLE > option[value=" + midSplit[i] + "]").text());
						playerCnt++;
					}
				}
				for(var i=0; i<defSplit.length; i++){
					if(defSplit[i] != ""){
						$("#player_" + playerCnt).val($("#PLAYER_SELECT_SAMPLE > option[value=" + defSplit[i] + "]").text());
						playerCnt++;
					}
				}
				for(var i=0; i<keepSplit.length; i++){
					if(keepSplit[i] != ""){
						$("#player_" + playerCnt).val($("#PLAYER_SELECT_SAMPLE > option[value=" + keepSplit[i] + "]").text());
						playerCnt++;
					}
				}
            },
            error : function(err) {
                alert("오류발생 관리자에게 문의하세요.")
            }
        });
	}
	
	function viewBestPlayerList(){
		
        $.ajax({
            type : "post",
            url : './get.php',
            data : {
                cmd : "best_formation_view_list",
                id : 1
            },
            dataType : "json",
            success : function(data) {
				$("#VIEW_ID").html("<option value=''>선택</option>");
				for(var i=0; i<data.length; i++){
					$("#VIEW_ID").append("<option value='"+data[i]["fid"]+"'>"+data[i]["reg_name"]+"</option>")
				}
            },
            error : function(err) {
                alert("오류발생 관리자에게 문의하세요.")
            }
        });
	}
</script>
<style>
</style>
</head>
<body>

    <div id="headers"></div>
	<div class="container">
		<div class="row">&nbsp;</div>
		<h2>2021년 BEST 11 보기.</h2>
		<div class="input-group">
			<span class="input-group-text">작성자</span>
			<select class="form-select" id="VIEW_ID" onchange="viewBestPlayer();"></select>
		</div>
		<div class="row">&nbsp;</div>
		<div class="input-group">
			<span class="input-group-text">포메이션</span>
			<input type="text" class="form-control" id="REG_FORMATION" readonly/>
		</div>
		<div class="row">&nbsp;</div>
		<div class="row">
			<table class="table" style="height:500px; text-align: center;vertical-align: middle;">
				<tr class="table-primary">
					<td>
						<div class="row" id="POSITION_ATT" style="text-align: -webkit-center;">&nbsp;</div>
					</td>
				</tr>
				<tr class="table-success">
					<td>
						<div class="row" id="POSITION_MID" style="text-align: -webkit-center;">&nbsp;</div>
					</td>
				</tr>
				<tr class="table-warning">
					<td>
						<div class="row" id="POSITION_DEF" style="text-align: -webkit-center;">&nbsp;</div>
					</td>
				</tr>
				<tr class="table-secondary">
					<td>
						<div class="row" id="POSITION_KEEP" style="text-align: -webkit-center;">&nbsp;</div>
					</td>
				</tr>
			</table>
			<select id="PLAYER_SELECT_SAMPLE" style="display: none;">
				<option value="">N/A</option>
			</select>
		</div>
		<div class="row">&nbsp;</div>
		<div class="row">
			<div class="col" id="VIEW_BEST_PLAYER_DIV"></div>
		</div>
		<div class="row">&nbsp;</div>
		<div id='footers'></div>
	</div>
</body>
</html>