<script>
	var difWindowHeight = 320;

	$(document).ready(function(){
		var target_header = "match_duo";
		getTeam();
		$("#header_" + target_header).addClass("text-warning").removeClass("text-white");
		$("#drop_header").text($("#drop_header_" + target_header).text());

		getPlayers();

		tableResize();
		
		$('#searchStartDate').datepicker({
			format: "yyyy.mm.dd",
			autoclose: true,
			todayHighlight: true,
			language: "ko"
		});
		$('#searchEndDate').datepicker({
			format: "yyyy.mm.dd",
			autoclose: true,
			todayHighlight: true,
			language: "ko"
		});
	});

	$(window).resize(function(){
		tableResize();
	});

	function tableResize(){
		var wh = $(window).height();
		$(".TABLE_INNER_DIV").each(function(){
			//$(this).css("height", wh - difWindowHeight);
		})
	}
	
	function getPlayers(){
		//tableBody
		$.ajax({
			type : "post",
			url : '/football_tpm/get.php',
			data : {
				cmd : "player",
				id : TEAM_ID
			},
			dataType : "json",
			success : function(data) {
				var div = $("#player_list_div");
				div.html("");
				for(var i=0; i<data.length; i++){
					var str = "<button class='btn btn-outline-primary btn-sm' id='p_"+data[i]["player_id"]+"'";
						str += " onclick='selectPlayer("+data[i]["player_id"]+", \""+data[i]["player_name"]+"\")'>";
						str += "" + data[i]["player_name"];
						str += "</button>";
					div.append(str);
				}
			},
			error : function(err) {
				alert("오류발생 관리자에게 문의하세요.")
			}
		});
	}

	var selectedPlayer = 0;
	function selectPlayer(pid, pname){
		selectedPlayer = pid;
		$("#tableResult").text(pname)
		getMatchRecordsTogether();
	}

	function clearTogether(){
		var body = $("#tableBody");
		body.html("");
		$("#SELECTED_PLAYERS").html("");
	}

	function getMatchRecordsTogether(){
		clearTogether();
		$("#tableResultDate").text($("#searchStartDate").val() + "~" + $("#searchEndDate").val())
		$.ajax({
			type : "post",
			url : '/football_tpm/get.php',
			data : {
				cmd : "match_duo",
				id : TEAM_ID,
				player_id: selectedPlayer,
				from: $("#searchStartDate").val(),
				to: $("#searchEndDate").val()
			},
			dataType : "json",
			success : function(data) {
				var body = $("#tableBody");
				body.html("");

				for(var i=0; i<data.length; i++){
					var bgColor = "#FFFFFF";
					var str = "";
					str += "<tr>";
					str += "<td>"+data[i]["player_name"]+"</td>";
					str += "<td>"+data[i]["play_cnt"]+"</td>";
					str += "<td>"+data[i]["pts"]+"</td>";
					str += "<td>"+data[i]["win_cnt"]+"</td>";
					str += "<td>"+data[i]["draw_cnt"]+"</td>";
					str += "<td>"+data[i]["lose_cnt"]+"</td>";
					str += "<td>"+data[i]["goal_cnt"]+"/"+data[i]["asst_cnt"]+"</td>";
					str += "</tr>";
					body.append(str);
				}

				location.href = '#TABLE_RESULT_DIV';
			},
			error : function(err) {
				alert("오류발생 관리자에게 문의하세요.")
			}
		});
	}

	$(window).scroll(function(){
		console.log($(window).scrollTop() + " " + $(".TABLE_INNER_DIV").offset().top);
	});
</script>
<style>
	@media (max-width:861px) {
		.PLUS_MINUS {
			display: none;
		}
		.VALUE_INPUT {
			width: 100%!important;
		}
	}
</style>
	<div class="container" style="max-width:100%;">
		<div class="row">&nbsp;</div>
		<div id="">
			<h5>[선수 듀오 별 기록]
				<div class="input-group" style="margin-top:5px;">
					<span class="input-group-text">기간</span>
					<input type="text" class="form-control auto_font_size" readonly="readonly" id="searchStartDate" value=""/>
					<span class="input-group-text">~</span>
					<input type="text" class="form-control auto_font_size" readonly="readonly" id="searchEndDate" value=""/>
					<button class="btn btn-primary" onclick="getMatchRecordsTogether();">VIEW</button>
				</div>
			</h5>
			<div class="row">
				<div class="col">
					<table class="table auto_font_size" style="width:100%; text-align:center;">
						<thead>
							<tr>
								<th scope="col" style="min-width: 130px;">선수리스트</th>
							</tr>
						</thead>
						<tbody style="font-size:12px;">
							<tr>
								<td>
									<div class="TABLE_INNER_DIV" style="min-width:150px; width:100%; overflow-x: hidden; overflow-y: auto; max-height:1000px;" id="player_list_div">
									</div>
								</td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>
			<div class="row" id="TABLE_RESULT_DIV">
				<div class="col">
					<div class="align-top TABLE_INNER_DIV" style="width:100%; text-align:center;">
						<h5 id="tableResult"></h5>
						<h5 id="tableResultDate"></h5>
						<table class="table table-sm auto_font_size">
							<colgroup>
								<col width="10%"/>
								<col width="10%"/>
								<col width="10%"/>
								<col width="10%"/>
								<col width="10%"/>
								<col width="10%"/>
								<col width="10%"/>
							</colgroup>
							<thead>
								<tr>
									<td>PLAYER</td>
									<td>PLAYS</td>
									<td>PTS</td>
									<td>WIN</td>
									<td>DRAW</td>
									<td>LOSE</td>
									<td>GOAL/ASST</td>
								</tr>
							</thead>
							<tbody id="tableBody"></tbody>
						</table>
					</div>
				</div>
			</div>
			<div class="row">&nbsp;</div>
            <!-- <div class="row">
                <div class="col">
					<button type="button" class="btn btn-secondary" onclick="hideCreateMatch();">Close</button>
					<button type="button" class="btn btn-primary" onclick="saveMatch();">SAVE</button>
                </div>
            </div>
			<div class="row">&nbsp;</div> -->
			<div class="row" style="border-top: 1px solid #333;">&nbsp;</div>
		</div>
    </div>
	